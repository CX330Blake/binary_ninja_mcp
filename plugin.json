{
    "pluginmetadataversion": 2,
    "name": "Binary Ninja MCP Max",
    "author": "CX330Blake",
    "type": ["core", "binaryview", "architecture", "helper"],
    "api": ["python3"],
    "description": "A Binary Ninja plugin that provides a MCP (Model Context Protocol) server with HTTP endpoints for LLM integration.",
    "longdescription": "# Binary Ninja MCP <img src=\"images/binja.png\" height=\"24\" style=\"margin-left: 5px; vertical-align: middle;\">\n\nThis repository contains a Binary Ninja plugin, MCP server, and bridge that enables seamless integration of Binary Ninja's capabilities with your favorite LLM client.\n\n## Features\n\n- Seamless, real-time integration between Binary Ninja and MCP clients\n- Enhanced reverse engineering workflow with AI assistance\n- Support for every MCP client (Cline, Claude desktop, Roo Code, etc)\n\n## Examples\n\n### Solving a CTF Challenge\n\nhttps://github.com/user-attachments/assets/67b76a53-ea21-4bef-86d2-f751b891c604\n\nYou can also watch the demo video on [YouTube](https://www.youtube.com/watch?v=0ffMHH39L_M)\n\n## Components\n\nThis repository contains two separate components:\n\n1. A Binary Ninja plugin that provides an MCP server that exposes Binary Ninja's capabilities through HTTP endpoints. This can be used with any client that implements the MCP protocol.\n2. A separate MCP bridge component that connects your favorite MCP client to the Binary Ninja MCP server. While Claude Desktop is the primary integration path, the MCP server can be used with other clients.\n\n## Supported Integrations\n\nThe following table lists available MCP tools. Sorted alphabetically by function name.\n\n| Function                                      | Description                                                                                 |\n| --------------------------------------------- | ------------------------------------------------------------------------------------------- |\n| `convert_number(text, size)`                  | Convert a number/string to multiple representations (LE/BE, bases).                         |\n| `decompile_function`                          | Decompile a specific function by name and return the decompiled C code.                     |\n| `define_types`                                | Add type definitions from a C string type definition.                                       |\n| `delete_comment`                              | Delete the comment at a specific address.                                                   |\n| `delete_function_comment`                     | Delete the comment for a function.                                                          |\n| `format_value(address, text, size)`           | Convert a value and annotate it at an address in BN (adds a comment).                       |\n| `function_at`                                 | Retrieve the name of the function the address belongs to.                                   |\n| `get_assembly_function`                       | Get the assembly representation of a function by name or address.                           |\n| `get_binary_status`                           | Get the current status of the loaded binary.                                                |\n| `get_comment`                                 | Get the comment at a specific address.                                                      |\n| `get_function_comment`                        | Get the comment for a function.                                                             |\n| `get_user_defined_type`                       | Retrieve definition of a user-defined type (struct, enumeration, typedef, union).           |\n| `get_xrefs_to(address)`                       | Get all cross references (code and data) to an address.                                     |\n| `get_data_decl(name_or_address, length)`      | Return a C-like declaration and a hexdump for a data symbol or address.                     |\n| `hexdump_address(address, length)`            | Text hexdump at address. `length < 0` reads exact defined size if available.                |\n| `hexdump_data(name_or_address, length)`       | Hexdump by data symbol name or address. `length < 0` reads exact defined size if available. |\n| `get_xrefs_to_enum(enum_name)`                | Get usages related to an enum (matches member constants in code).                           |\n| `get_xrefs_to_field(struct_name, field_name)` | Get all cross references to a named struct field.                                           |\n| `get_xrefs_to_struct(struct_name)`            | Get xrefs/usages related to a struct (members, globals, code refs).                         |\n| `get_xrefs_to_type(type_name)`                | Get xrefs/usages related to a struct/type (globals, refs, HLIL matches).                    |\n| `get_xrefs_to_union(union_name)`              | Get xrefs/usages related to a union (members, globals, code refs).                          |\n| `get_type_info(type_name)`                    | Resolve a type and return declaration, kind, and members.                                   |\n| `list_all_strings()`                          | List all strings (no pagination; aggregates all pages).                                     |\n| `list_classes`                                | List all namespace/class names in the program.                                              |\n| `list_data_items`                             | List defined data labels and their values.                                                  |\n| `list_exports`                                | List exported functions/symbols.                                                            |\n| `list_imports`                                | List imported symbols in the program.                                                       |\n| `list_local_types(offset, count)`             | List local Types in the current database (name/kind/decl).                                  |\n| `list_methods`                                | List all function names in the program.                                                     |\n| `list_namespaces`                             | List all non-global namespaces in the program.                                              |\n| `list_segments`                               | List all memory segments in the program.                                                    |\n| `list_strings(offset, count)`                 | List all strings in the database (paginated).                                               |\n| `list_strings_filter(offset, count, filter)`  | List matching strings (paginated, filtered by substring).                                   |\n| `rename_data`                                 | Rename a data label at the specified address.                                               |\n| `rename_function`                             | Rename a function by its current name to a new user-defined name.                           |\n| `rename_variable`                             | Rename variable inside a given function.                                                    |\n| `retype_variable`                             | Retype variable inside a given function.                                                    |\n| `search_functions_by_name`                    | Search for functions whose name contains the given substring.                               |\n| `search_types(query, offset, count)`          | Search local Types by substring (name/decl).                                                |\n| `set_comment`                                 | Set a comment at a specific address.                                                        |\n| `set_function_comment`                        | Set a comment for a function.                                                               |\n\nHTTP endpoints\n\n- `/allStrings`: All strings in one response.\n- `/convertNumber?text=<value>&size=<n>`: Convert number/string to hex/dec/bin and LE/BE.\n- `/formatValue?address=<addr>&text=<value>&size=<n>`: Convert and set a comment at an address.\n- `/getXrefsTo?address=<addr>`: Xrefs to address (code+data).\n- `/getDataDecl?name=<symbol>|address=<addr>&length=<n>`: JSON with declaration-style string and a hexdump for a data symbol or address. Keys: `address`, `name`, `size`, `type`, `decl`, `hexdump`. `length < 0` reads exact defined size if available.\n- `/hexdump?address=<addr>&length=<n>`: Text hexdump aligned at address; `length < 0` reads exact defined size if available.\n- `/hexdumpByName?name=<symbol>&length=<n>`: Text hexdump by symbol name. Recognizes BN auto-labels like `data_<hex>`, `byte_<hex>`, `word_<hex>`, `dword_<hex>`, `qword_<hex>`, `off_<hex>`, `unk_<hex>`, and plain hex addresses.\n- `/makeFunctionAt?address=<addr>&platform=<name|default>`: Create a function at an address (idempotent if already exists). Platform is optional.\n- `/platforms`: List available platforms.\n- `/data?offset=<n>&limit=<m>&length=<n>`: Defined data items with previews. `length` controls bytes read per item (capped at defined size). Default behavior reads exact defined size when available; `length=-1` forces exact-size.\n- `/getXrefsToEnum?name=<enum>`: Enum usages by matching member constants.\n- `/getXrefsToField?struct=<name>&field=<name>`: Xrefs to struct field.\n- `/getXrefsToType?name=<type>`: Xrefs/usages related to a struct/type name.\n- `/getTypeInfo?name=<type>`: Resolve a type and return declaration and details.\n- `/getXrefsToUnion?name=<union>`: Union xrefs/usages (members, globals, refs).\n- `/localTypes?offset=<n>&limit=<m>`: List local types.\n- `/strings?offset=<n>&limit=<m>`: Paginated strings.\n- `/strings/filter?offset=<n>&limit=<m>&filter=<substr>`: Filtered strings.\n- `/searchTypes?query=<substr>&offset=<n>&limit=<m>`: Search local types by substring.\n\n## Prerequisites\n\n- [Binary Ninja](https://binary.ninja/)\n- Python 3.12+\n- [Claude Desktop](https://claude.ai/download) (or your preferred integration)\n\n## Installation\n\n### Binary Ninja Plugin Manager\n\nYou may install the plugin through Binary Ninja's Plugin Manager (`Plugins > Manage Plugins`). When installed via the Plugin Manager, the plugin resides under:\n\n- macOS: `~/Library/Application Support/Binary Ninja/plugins/repositories/community/plugins/CX330Blake_binary_ninja_mcp_max`\n- Linux: `~/.binaryninja/plugins/repositories/community/plugins/CX330Blake_binary_ninja_mcp_max`\n- Windows: `%APPDATA%\\Binary Ninja\\plugins\\repositories\\community\\plugins\\CX330Blake_binary_ninja_mcp_max`\n\nTo manually configure the plugin, this repository can be copied into the Binary Ninja plugins folder.\n\n#### Automatic MCP Client Setup\n\nThe plugin includes an automatic installer that wires up supported MCP clients to this server using the key `binary_ninja_mcp_max`.\n\n- First run: When Binary Ninja loads the plugin, it will:\n  - Create a local venv under this plugin at `.venv/` (if missing) and install `bridge/requirements.txt`.\n  - Add an entry for `binary_ninja_mcp_max` to known MCP client configs (Cline, Roo Code, Claude Desktop, Cursor, Windsurf, Claude Code, LM Studio) when their config files are present.\n  - Write `.mcp_auto_setup_done` at the plugin root to avoid repeating on every launch.\n\n- Re-run auto-setup: Delete the `.mcp_auto_setup_done` file or run the uninstall command below; then restart Binary Ninja or run the installer again.\n\n#### CLI Installer (all platforms)\n\nYou can also manage MCP client entries from the command line:\n\n```bash\npython scripts/mcp_client_installer.py --install    # add/update entries\npython scripts/mcp_client_installer.py --uninstall  # remove entries and delete .mcp_auto_setup_done\npython scripts/mcp_client_installer.py --config     # print a generic JSON config snippet\n```\n\n- Use `--quiet` to reduce output. The installer preserves any existing `env` overrides for this server key.\n\n### Manual Configuration\n\nFor other MCP clients:\n\n```json\n{\n    \"mcpServers\": {\n        \"binary_ninja_mcp_max\": {\n            \"command\": \"/ABSOLUTE/PATH/TO/Binary\\ Ninja/plugins/repositories/community/plugins/CX330Blake_binary_ninja_mcp_max/.venv/bin/python\",\n            \"args\": [\n                \"/ABSOLUTE/PATH/TO/Binary\\ Ninja/plugins/repositories/community/plugins/CX330Blake_binary_ninja_mcp_max/bridge/binja_mcp_bridge.py\"\n            ]\n        }\n    }\n}\n```\n\nNote: Replace `/ABSOLUTE/PATH/TO` with the actual absolute path to your project directory. The virtual environment's Python interpreter must be used to access the installed dependencies.\n\n## Usage\n\n1. Open Binary Ninja and install the `Binary Ninja MCP` plugin\n2. Restart Binary Ninja and then open a binary\n3. Click the button shown at left bottom corner\n4. Start using it through your MCP client\n\nYou may now start prompting Claude about the currently open binary. Example prompts:\n\n- \"Generate a binary analysis report for the current binary.\"\n- \"Rename function X to Y in the current binary.\"\n- \"List all functions in the current binary.\"\n- \"What is the status of the loaded binary?\"\n\n### Other MCP Client Integrations\n\nThe bridge can be used with other MCP clients by implementing the appropriate integration layer.\n\n## Development\n\n### Quick Start\n\n```bash\ngit clone <this-repo>\ncd binary_ninja_mcp_max\n\n# Create a local venv and install bridge deps\npython3 -m venv .venv\nsource .venv/bin/activate   # macOS/Linux\npip install -r bridge/requirements.txt\n\n# Optional: register the MCP server with supported clients\npython scripts/mcp_client_installer.py --install\n```\n\nThen open Binary Ninja, load a binary, and start the server if it\u2019s not already running:\n\n- Binary Ninja menu: Plugins > MCP Server > Start MCP Server\n\nThe server listens on `http://localhost:9009` and exposes HTTP endpoints consumed by the bridge.\n\n### Test Locally (HTTP)\n\nAfter the server is running in Binary Ninja, you can sanity-check endpoints from a terminal:\n\n```bash\ncurl http://localhost:9009/status\ncurl \"http://localhost:9009/functions?offset=0&limit=10\"\n```\n\n### Working on the Bridge\n\n- Entry point: `bridge/binja_mcp_bridge.py` (run by your MCP client).\n- The CLI installer configures MCP clients to use:\n  - `command`: the plugin\u2019s `.venv` Python\n  - `args`: `[bridge/binja_mcp_bridge.py]`\n- Edit tools in `bridge/binja_mcp_bridge.py` and re-run from your MCP client (e.g., Claude Desktop, Cline) to pick up changes.\n\n### Working on the Binary Ninja Plugin\n\n- Core server: `plugin/server/http_server.py` (served inside Binary Ninja).\n- Capabilities and endpoints live under `plugin/core/` and `plugin/api/`.\n- Logs appear in Binary Ninja\u2019s Log window; use them to debug requests and responses.\n\n### Reset or Reconfigure MCP Clients\n\n```bash\n# Remove entries and delete the auto-setup marker (.mcp_auto_setup_done)\npython scripts/mcp_client_installer.py --uninstall\n\n# Re-install entries\npython scripts/mcp_client_installer.py --install\n```\n\nDeleting the `.mcp_auto_setup_done` file at the repo root also forces the plugin\u2019s one-time auto-setup to run again on next load.\n\n### Project Layout\n\n```\nbinary_ninja_mcp_max/\n\u251c\u2500\u2500 bridge/                      # MCP tools (client side)\n\u251c\u2500\u2500 plugin/                      # Binary Ninja plugin + HTTP server (server side)\n\u251c\u2500\u2500 scripts/                     # Installers and helpers\n\u2502   \u2514\u2500\u2500 mcp_client_installer.py\n\u2514\u2500\u2500 README.md\n```\n\n## Contributing\n\nContributions are welcome. Please feel free to submit a pull request.\n",
    "license": {
        "name": "GPL-3.0",
        "text": "Copyright 2025 CX330Blake\n\nThis program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>."
    },
    "platforms": ["Darwin", "Windows", "Linux"],
    "installinstructions": {
        "Darwin": "See https://github.com/CX330Blake/binary-ninja-mcp-max",
        "Windows": "See https://github.com/CX330Blake/binary-ninja-mcp-max",
        "Linux": "See https://github.com/CX330Blake/binary-ninja-mcp-max"
    },
    "version": "0.5.0",
    "minimumbinaryninjaversion": 4000
}
